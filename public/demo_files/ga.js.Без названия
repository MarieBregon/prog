"undefined"!=typeof certainly?initGAExtension():window.addEventListener("onWidgetReady",()=>{initGAExtension()});function initGAExtension(){certainly.google_analytics={tracker:"",last_sent_event:"",chat_start_tracked:!1,postEvent:function(){}},certainly.google_analytics.postEvent=function(e){if(/.*\{*\}.*/.test(e)&&(e=(e=JSON.parse(e)).eventAction?e.eventAction:"undefined"),e=`certainly_${e=e.replace("certainly_","").replace("Certainly_","")}`,"undefined"!=typeof gtag&&gtag("event",e,{event_category:"certainly",event_action:e,event_label:e}),"undefined"!=typeof ga){var t=ga.getAll();certainly.google_analytics.tracker=t[0],certainly.google_analytics.tracker.send("event",{eventCategory:"certainly",eventAction:e,eventLabel:e})}"undefined"==typeof gtag&&"object"==typeof dataLayer&&dataLayer.push({event:e})},window.addEventListener("onWidgetOpened",({detail:e})=>{"FAB"==e.from&&certainly.google_analytics.postEvent("widget_opened")}),window.addEventListener("onWidgetClosed",({detail:e})=>{"X"==e.from&&certainly.google_analytics.postEvent("widget_closed")}),window.addEventListener("onMessageAdded",({detail:e})=>{"human"==e.from&&(certainly.google_analytics.chat_started||(certainly.google_analytics.postEvent("chat_started"),certainly.google_analytics.chat_started=!0),certainly.google_analytics.postEvent("message_from_visitor"))}),window.addEventListener("certainly",function(e){e.detail.public&&e.detail.label&&certainly.google_analytics.postEvent(e.detail.label)}),certainly.getCertainlyTransfer({actionName:"*",callback(e){if(""==e.cvars){console.log("You need to enable your Certainly bot to share custom variables with the website");return}if(e.message.bot_module.kpi_tags.filter(e=>"Fallback"==e.label).length>0){console.log(!0);var t="fallback";certainly.google_analytics.postEvent(t)}if(e.message.bot_module.kpi_tags.filter(e=>"Handover"==e.label).length>0){console.log(!0);var t="handover";certainly.google_analytics.postEvent(t)}if(e.cvars.google_analytics_event||e.cvars.ga_event){var t=e.cvars.google_analytics_event||e.cvars.ga_event;t!=certainly.google_analytics.last_sent_event&&(certainly.google_analytics.last_sent_event=t,certainly.google_analytics.postEvent(t))}}})}